
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.9 Exercise: Packaging Troll Treasure &#8212; Research Software Engineering with Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Construction and Design" href="../module07_construction_and_design/index.html" />
    <link rel="prev" title="6.8 Managing software issues" href="06_08_software_issues.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/ATI_logo_black_W1024px.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Research Software Engineering with Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Research Software Engineering with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Prerequisites
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../course_prerequisites/index.html">
   Installation Instructions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../course_prerequisites/01_git.html">
     Git &amp; GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../course_prerequisites/02_python.html">
     Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../course_prerequisites/03_editor.html">
     Text Editor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../course_prerequisites/04_jupyter.html">
     Course Contents in Jupyter
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module01_introduction_to_python/index.html">
   1. Introduction to Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_00_introduction_to_python.html">
     1.0 Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_01_variables.html">
     1.1 Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_02_using_functions.html">
     1.2 Using Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_03_types.html">
     1.3 Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_04_containers.html">
     1.4 Containers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_05_dictionaries.html">
     1.5 Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_06_data_structures.html">
     1.6 Data structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_07_control_and_flow.html">
     1.7 Control and Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_08_iteration.html">
     1.8 Iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module01_introduction_to_python/01_09_classroom_exercises.html">
     1.9 Classroom Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module02_intermediate_python/index.html">
   2. Intermediate Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_00_comprehensions.html">
     2.0 Comprehensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_01_functions.html">
     2.1 Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_02_using_libraries.html">
     2.2 Using Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_03_working_with_files.html">
     2.3 Working with files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_04_getting_data_from_the_internet.html">
     2.4 Getting data from the Internet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_05_data_analysis_example.html">
     2.5 Data analysis example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_06_defining_classes.html">
     2.7 Defining your own classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_07_data_analysis_with_classes.html">
     2.7 Data analysis with classes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module02_intermediate_python/02_08_classroom_exercises.html">
     2.7 Classroom Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module03_research_data_in_python/index.html">
   3. Research Data in Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_00_scientific_python.html">
     3.0 Scientific Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_01_fields_and_records.html">
     3.1 Field and Record Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_02_structured_data.html">
     3.2 Structured Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_03_plotting_with_matplotlib.html">
     3.3 Plotting with Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_04_NumPy.html">
     3.4 NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_05_advanced_numpy.html">
     3.5 Advanced NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_06_boids.html">
     3.6 The Boids!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module03_research_data_in_python/03_07_classroom_exercises.html">
     3.7 Classroom Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module04_version_control_with_git/index.html">
   4. Version Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_00_introduction.html">
     4.0 Introduction to version control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_01_solo_work_with_git.html">
     4.1 Solo work with git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_02_fixing_mistakes.html">
     4.2 Fixing mistakes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_03_publishing.html">
     4.3 Publishing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_04_collaboration.html">
     4.4 Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_05_fork_and_pull.html">
     4.5 Fork and Pull
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_06_git_theory.html">
     4.6 Git Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_07_branches.html">
     4.7 Branches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_08_advanced_git_concepts.html">
     4.8 Advanced git concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_09_github_pages.html">
     4.9 Publishing from GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_10_rebasing.html">
     4.10 Rebasing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_11_debugging_with_git_bisect.html">
     4.11 Debugging With git bisect
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module04_version_control_with_git/04_12_multiple_remotes.html">
     4.12 Working with multiple remotes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module05_testing_your_code/index.html">
   5. Testing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_00_introduction.html">
     5.0 Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_01_how_to_test.html">
     5.1 How to test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_02_testing_frameworks.html">
     5.2 Testing frameworks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_03_energy_example.html">
     5.3 Classroom exercise: energy calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_04_mocking.html">
     5.4 Mocking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_05_using_a_debugger.html">
     5.5 Using a debugger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_06_continuous_integration.html">
     5.6 Continuous Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module05_testing_your_code/05_07_diffusion_example.html">
     Recap example: Monte-Carlo
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   6. Software Projects
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="06_00_libraries.html">
     6.0 Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_01_installing_packages.html">
     6.1 Installing libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_02_managing_dependencies.html">
     6.2 Managing Dependencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_03_non_notebook_python.html">
     6.3 Python outside the notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_04_packaging.html">
     6.4 Packaging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_05_documentation.html">
     6.5 Documentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_06_software_development.html">
     6.6 Software Project Management
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_07_software_licensing.html">
     6.7 Software Licensing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_08_software_issues.html">
     6.8 Managing software issues
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.9 Exercise: Packaging Troll Treasure
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module07_construction_and_design/index.html">
   7. Construction and Design
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_00_introduction.html">
     7.0 Construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_01_comments.html">
     7.1 Comments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_02_coding_conventions.html">
     7.2 Coding conventions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_04_refactoring.html">
     7.4 Refactoring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_05_object_oriented_design.html">
     7.5 Object-Oriented Design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_06_classes.html">
     7.6 Class design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_07_design_patterns.html">
     7.7 Design Patterns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module07_construction_and_design/07_08_refactoring_boids.html">
     7.8 Exercise: Refactoring The Bad Boids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module08_advanced_programming_techniques/index.html">
   8. Advanced Programming Techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_00_introduction.html">
     8.0 Advanced Python Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_01_functional_programming.html">
     8.1 Functional programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_02_iterators_and_generators.html">
     8.2 Iterators and Generators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_03_exceptions.html">
     8.3 Exceptions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_04_operator_overloading.html">
     8.4 Operator overloading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_05_metaprogramming.html">
     8.5 Metaprogramming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module08_advanced_programming_techniques/08_06_advanced_operator_overloading.html">
     8.6 Advanced operator overloading
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module09_programming_for_speed/index.html">
   9. Programming for Speed
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_00_performance_programming.html">
     9.0 Performance programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_01_optimising_mandelbrot.html">
     9.1 Optimising Mandelbrot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_02_optimising_with_numpy.html">
     9.2 Optimising with NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_03_optimising_with_cython.html">
     9.3 Optimising with Cython
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_04_optimising_with_numba.html">
     9.5 Optimising with Numba
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module09_programming_for_speed/09_05_performance_scaling.html">
     9.5 Performance scaling for containers and algorithms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module10_scientific_file_formats/index.html">
   10. Scientific file formats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_00_serialisation_and_normalisation.html">
     10.0 Serialising and normalising data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_01_deserialisation.html">
     10.1 Deserialisation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_02_binary_formats.html">
     10.2 Binary formats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_03_markup_languages.html">
     10.3 Markup Languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_04_beyond_pandas.html">
     10.04 Larger datasets - beyond pandas and csv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_05_processing_in_parallel.html">
     10.5 Processing in parallel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_06_geospatial_data.html">
     10.6 Geospatial data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_x0_optional_domain_specific_languages.html">
     10.x.0 (OPTIONAL):  Domain specific languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_x1_optional_controlled_vocabularies.html">
     10.x.1 (OPTIONAL): Controlled Vocabularies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module10_scientific_file_formats/10_x2_optional_semantic_models.html">
     10.x.2 (OPTIONAL):  Semantic file formats
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../solutions/index.html">
   Exercise Solutions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_01.html">
     Module 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_02.html">
     Module 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_03.html">
     Module 03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_04.html">
     Module 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_05.html">
     Module 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_06.html">
     Module 06: Troll Treasure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_07.html">
     Module 07: Bad Boids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_08.html">
     Module 08
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_09.html">
     Module 09
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../solutions/module_10.html">
     Module 10
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            <p>Download notes as <a href="/rse-course/pdf/book.pdf">PDF</a>.</p>
<p>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>.</p>

            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/alan-turing-institute/rse-course/main?urlpath=tree/module06_software_projects/06_09_exercise.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/alan-turing-institute/rse-course"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/alan-turing-institute/rse-course/issues/new?title=Issue%20on%20page%20%2Fmodule06_software_projects/06_09_exercise.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/alan-turing-institute/rse-course/edit/main/module06_software_projects/06_09_exercise.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/module06_software_projects/06_09_exercise.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-to-do">
   What to do
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extensions">
     Extensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code">
   Code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rooms">
     Rooms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treasure">
     Treasure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agents">
     Agents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dungeons">
     Dungeons
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#games">
     Games
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#playing-games">
   Playing Games
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dungeon-yaml-files">
     Dungeon YAML files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-a-single-game">
     Run a single game
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimate-outcome-probabilities">
     Estimate outcome probabilities
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>6.9 Exercise: Packaging Troll Treasure</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-to-do">
   What to do
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extensions">
     Extensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code">
   Code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rooms">
     Rooms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treasure">
     Treasure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agents">
     Agents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dungeons">
     Dungeons
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#games">
     Games
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#playing-games">
   Playing Games
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dungeon-yaml-files">
     Dungeon YAML files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-a-single-game">
     Run a single game
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimate-outcome-probabilities">
     Estimate outcome probabilities
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-packaging-troll-treasure">
<h1>6.9 Exercise: Packaging Troll Treasure<a class="headerlink" href="#exercise-packaging-troll-treasure" title="Permalink to this headline">#</a></h1>
<p>We are going to look at a simplified version of a game with a <a class="reference external" href="https://en.wikipedia.org/wiki/Hunt_the_Wumpus">long history</a>. Games of this kind have been used as test-beds for development of artificial intelligence.</p>
<p>A <em>dungeon</em> is a network of connected <em>rooms</em> on a square grid. One or more rooms contain <em>treasure</em>. Your character, the <em>adventurer</em>, moves between rooms, looking for the treasure.
A <em>troll</em> is also in the dungeon and moves between rooms. If the troll catches the adventurer, you lose. If you find treasure before being eaten, you win. (In this simple version, we do not consider the need to leave the dungeon.)</p>
<p>The starting rooms for the adventurer and troll are given in the definition of the dungeon.</p>
<p>The way the adventurer and troll move is called a <em>strategy</em>. Different strategies are more or less likely to succeed. There are two strategies in the provided code - random movement, and movement controlled by human input.</p>
<p>The code provides a function to play a single game, or to simulate many games and estimate the probability the adventurer or troll wins.</p>
<p>In this exercise, you will convert the code provided in this Jupyter notebook into a proper Python package.</p>
<section id="what-to-do">
<h2>What to do<a class="headerlink" href="#what-to-do" title="Permalink to this headline">#</a></h2>
<p>Using the course material from this module to help:</p>
<p><strong>1.</strong> Briefly familiarise yourself with the code below and how it works/runs, focusing on the different classes and functions that are defined rather than the implementation details. And try running a game in the notebook (see the <a class="reference external" href="#playing-games">Playing Games</a> section).</p>
<p><strong>2.</strong> Make a directory for your project</p>
<p><strong>3.</strong> Create a directory to contain your package (in your project directory) and copy the code from this notebook to it using multiple <code class="docutils literal notranslate"><span class="pre">.py</span></code> files. Remember to add <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file(s).</p>
<p><strong>4.</strong> Create a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to specify the metadata and dependencies for the package. The dependencies are <a class="reference external" href="https://pypi.org/project/PyYAML/">PyYAML</a> version 6.0 and <a class="reference external" href="https://pypi.org/project/art/">art</a> version 5.7.</p>
<p><strong>5.</strong> Create a virtual environment and activate it</p>
<p><strong>6.</strong> Install the package in your virtual environment.</p>
<ul>
<li><p>⚠️ You might get an error that says something like <code class="docutils literal notranslate"><span class="pre">error:</span> <span class="pre">Multiple</span> <span class="pre">top-level</span> <span class="pre">packages</span> <span class="pre">discovered</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">flat-layout</span></code>. This is because <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> has detected multiple directories that look like python packages and doesn’t know which one to choose. You should be able to fix this by adding (only) one of these sections to your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">tool.setuptools</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="l l-Scalar l-Scalar-Plain">packages = [&quot;&lt;my_package_directory&gt;&quot;]</span><span class="w"></span>
</pre></div>
</div>
<p><em><strong>or</strong></em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">tool.setuptools.packages</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="l l-Scalar l-Scalar-Plain">include = [&quot;&lt;my_package_directory&gt;*&quot;]</span><span class="w"></span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">&lt;my_package_directory&gt;</span></code> with the name of the directory that contains your package (<code class="docutils literal notranslate"><span class="pre">.py</span></code> files)</p>
</li>
</ul>
<p><strong>7.</strong> Check that you can import your package and run a script to play a game.</p>
<p><strong>8.</strong> Make a command-line interface:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">argparse</span></code> to create a function that can be called from the command-line with the path to a dungeon YAML file, and the option to either run a single game or calculate probabilities.</p></li>
<li><p>Add a script to call your function to the <code class="docutils literal notranslate"><span class="pre">[project.scripts]</span></code> section of <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></p></li>
<li><p>Reinstall your package and verify the executable you defined can now be run from a terminal.</p></li>
</ul>
<section id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Permalink to this headline">#</a></h3>
<p>If you’d like to take this further here are some other things you could try, depending on your interests:</p>
<p><strong>9.</strong> Create a GitHub repo for your project. Try installing the package from GitHub.</p>
<p><strong>10.</strong> Add <code class="docutils literal notranslate"><span class="pre">README</span></code>, <code class="docutils literal notranslate"><span class="pre">LICENSE</span></code>, and <code class="docutils literal notranslate"><span class="pre">CITATION</span></code> files to your project directory.</p>
<p><strong>11.</strong> Improve documentation</p>
<ul class="simple">
<li><p>Add docstrings to functions to explain what they do, their inputs, and outputs (e.g. in numpydoc format)</p></li>
<li><p>Build a documentaion web-site with sphinx</p></li>
<li><p>Host the documentation on GitHub pages</p></li>
</ul>
<p><strong>12.</strong> Add unit tests</p>
<ul class="simple">
<li><p>Write unit tests, such as to verify the outcomes of the provided <code class="docutils literal notranslate"><span class="pre">test_xxx.yml</span></code> dungeon files.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">pytest</span></code> as a development dependency for your package (and install it)</p></li>
<li><p>Run the tests and verify they pass</p></li>
</ul>
<p><strong>13.</strong> Improve or extend the code (you may like to revisit this after the next module):</p>
<ul class="simple">
<li><p>Specify your own dungeons or create a function to auto-generate them</p></li>
<li><p>Create new movement behaviour classes for adventurers and trolls</p></li>
<li><p>Look for places the code could be refactored (to reduce repetition, for example)</p></li>
</ul>
</section>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">#</a></h2>
<section id="rooms">
<h3>Rooms<a class="headerlink" href="#rooms" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">direction</span></code> function determines the direction from grid point <code class="docutils literal notranslate"><span class="pre">a</span></code> to grid point <code class="docutils literal notranslate"><span class="pre">b</span></code> (length two tuples, x and y coordinte) if they are neighbouring points in the grid, or <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="n">point_a</span><span class="p">,</span> <span class="n">point_b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the direction from point_a to point_b, or None if they</span>
<span class="sd">    are not neighhbouring grid points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">point_b</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;nowhere&quot;</span>
    <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;left&quot;</span>
        <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;right&quot;</span>
    <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;up&quot;</span>
        <span class="k">if</span> <span class="n">point_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">point_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;down&quot;</span>

    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Room</span></code> has a location (point) and optionally can link to other <code class="docutils literal notranslate"><span class="pre">Room</span></code>s at neighbouring grid points. :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Room</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>  <span class="c1"># grid point of this room</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="n">links</span>  <span class="c1"># other rooms this rooms connects to</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_links</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `(x, y) in room_instance` returns `True` if `room_instance` has a link to</span>
<span class="sd">        a room at point `(x, y)`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">point</span> <span class="ow">in</span> <span class="p">[</span><span class="n">link</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_validate_links</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies all linked rooms are at neighbouring grid points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">direction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">point</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid link: </span><span class="si">{</span><span class="n">link</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> is not connected to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Rooms</span></code> is a collection of rooms (that must be on a square grid), with each room stored in a dictionary keyed by its <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> coordinate (point):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Rooms</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collection of rooms</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rooms</span><span class="p">):</span>
        <span class="c1"># rooms dictionary keyed by (x, y) coordinate (grid cell indices)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span> <span class="o">=</span> <span class="p">{</span><span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">:</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows Rooms objects to be iterated over (see Module 7)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rooms[(x, y)] will retrieve the room at coordinate (x, y) (where</span>
<span class="sd">        rooms is an instance of the Rooms class)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[</span><span class="n">point</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        (x, y) in rooms will return True if a room at coordinates (x, y)</span>
<span class="sd">        is in rooms (where rooms is an instance of the Rooms class)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">room_list</span><span class="p">):</span>
        <span class="n">rooms</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Room</span><span class="p">(</span><span class="n">room</span><span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">Room</span><span class="p">(</span><span class="n">link</span><span class="p">)</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">room</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">room</span> <span class="ow">in</span> <span class="n">room_list</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rooms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="treasure">
<h3>Treasure<a class="headerlink" href="#treasure" title="Permalink to this headline">#</a></h3>
<p>Treausre has a location (point) and a single character symbol to represent it when printing dungeon maps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Treasure</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>  <span class="c1"># (x, y) grid location of the treasure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>  <span class="c1"># single char symbol to show the treasure on dungeon maps</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">treasure_dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">treasure_dict</span><span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">],</span> <span class="n">treasure_dict</span><span class="p">[</span><span class="s2">&quot;symbol&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="agents">
<h3>Agents<a class="headerlink" href="#agents" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Agent</span></code> class stores general properties used by all agents (trolls or adventurers):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Agent</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base functionality to create and load (but not move) an Agent</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>  <span class="c1"># (x, y) grid location of the agent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>  <span class="c1"># e.g. adventurer or troll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>  <span class="c1"># single char symbol to show the agent on dungeon maps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>  <span class="c1"># print output on agent behaviour if True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_wait</span> <span class="o">=</span> <span class="n">allow_wait</span>  <span class="c1"># allow the agent to move nowhere</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rooms</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Use an Agent base class&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">agent_dict</span><span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">],</span>
            <span class="n">agent_dict</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="n">agent_dict</span><span class="p">[</span><span class="s2">&quot;symbol&quot;</span><span class="p">],</span>
            <span class="n">allow_wait</span><span class="o">=</span><span class="n">agent_dict</span><span class="p">[</span><span class="s2">&quot;allow_wait&quot;</span><span class="p">],</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">RandomAgent</span></code>s choose to move to a connecting room at random (or stay where they are):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>


<span class="k">class</span> <span class="nc">RandomAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Agent that makes random moves</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rooms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rooms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">]</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="c1"># this room isn&#39;t linked to anything, can&#39;t move</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is trapped&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># pick a random room to move to</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">rooms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">]</span><span class="o">.</span><span class="n">links</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_wait</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_room</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">direction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">new_room</span><span class="o">.</span><span class="n">point</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> moves </span><span class="si">{</span><span class="n">move</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">new_room</span><span class="o">.</span><span class="n">point</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">HumanAgent</span></code>s ask the user where to move next:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HumanAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Agent that prompts the user where to move next</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rooms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is trapped&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># populate movement options depending on available rooms</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_wait</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wait&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rooms</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;down&quot;</span><span class="p">)</span>

        <span class="c1"># prompt user for movement input</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="n">choice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Where will </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> move </span><span class="se">\n</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">? &quot;</span><span class="p">)</span>

        <span class="c1"># move the agent</span>
        <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dungeons">
<h3>Dungeons<a class="headerlink" href="#dungeons" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Dungeon</span></code> have rooms, a piece of treasure, an adventurer, and a troll, and provide the functionality to update the agents, check whether the treasure or adventurer have found, and to draw a map of the dungeon:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaml</span>


<span class="k">class</span> <span class="nc">Dungeon</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dungeon with:</span>
<span class="sd">    - Connected set of rooms on a square grid</span>
<span class="sd">    - The location of some treasure</span>
<span class="sd">    - An adventurer agent with an initial position</span>
<span class="sd">    - A troll agent with an initial position</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rooms</span><span class="p">,</span> <span class="n">treasure</span><span class="p">,</span> <span class="n">adventurer</span><span class="p">,</span> <span class="n">troll</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span> <span class="o">=</span> <span class="n">rooms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treasure</span> <span class="o">=</span> <span class="n">treasure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span> <span class="o">=</span> <span class="n">adventurer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">troll</span> <span class="o">=</span> <span class="n">troll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># the extent of the square grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">),</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">),</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Treasure</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> is not in the dungeon&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">point</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">adventure</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> is not in the dungeon&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">point</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">name</span><span class="si">}{</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span><span class="si">}</span><span class="s2"> is not in the dungeon&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="n">rooms</span> <span class="o">=</span> <span class="n">Rooms</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;rooms&quot;</span><span class="p">])</span>
        <span class="n">treasure</span> <span class="o">=</span> <span class="n">Treasure</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s2">&quot;treasure&quot;</span><span class="p">])</span>

        <span class="n">agent_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;adventurer&quot;</span><span class="p">,</span> <span class="s2">&quot;troll&quot;</span><span class="p">]</span>
        <span class="n">agents</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agent_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="n">agent</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
                <span class="n">agent_class</span> <span class="o">=</span> <span class="n">RandomAgent</span>
            <span class="k">elif</span> <span class="n">spec</span><span class="p">[</span><span class="n">agent</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;human&quot;</span><span class="p">:</span>
                <span class="n">agent_class</span> <span class="o">=</span> <span class="n">HumanAgent</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown agent type </span><span class="si">{</span><span class="n">spec</span><span class="p">[</span><span class="n">agent</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">agents</span><span class="p">[</span><span class="n">agent</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_class</span><span class="p">(</span><span class="o">**</span><span class="n">spec</span><span class="p">[</span><span class="n">agent</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rooms</span><span class="p">,</span> <span class="n">treasure</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="s2">&quot;adventurer&quot;</span><span class="p">],</span> <span class="n">agents</span><span class="p">[</span><span class="s2">&quot;troll&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the adventurer and the troll</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the adventurer found the treasure or the troll</span>
<span class="sd">        found the adventurer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">point</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">set_verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set whether to print output&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a map of the dungeon&quot;&quot;&quot;</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># room and character symbols</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">symbol</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">symbol</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">point</span> <span class="o">==</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">symbol</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;o&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>

                <span class="c1"># horizontal connections</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]):</span>
                    <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot; - &quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;   &quot;</span>

            <span class="c1"># vertical connections</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]):</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;   &quot;</span>
                <span class="n">layout</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="games">
<h3>Games<a class="headerlink" href="#games" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Game</span></code> class runs a dungeon until the adventurer or troll wins, or calls a draw if neither wins in a given number of steps, and can simulate many games to estimate outcome probabilities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">art</span> <span class="kn">import</span> <span class="n">tprint</span>


<span class="k">class</span> <span class="nc">Game</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dungeon</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span> <span class="o">=</span> <span class="n">dungeon</span>

    <span class="k">def</span> <span class="nf">preamble</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tprint</span><span class="p">(</span><span class="s2">&quot;Troll Treasure</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">The </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is looking for treasure in a mysterious dungeon.</span>
<span class="s2">Will they succeed or be dinner for the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> that lurks there?</span>

<span class="s2">The map of the dungeon is below:</span>
<span class="s2">o : an empty room</span>
<span class="s2">o - o : connected rooms</span>
<span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"></span>
<span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"></span>
<span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">treasure</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> : the treasure</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">start_prompt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">dungeon</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="p">)</span>
        <span class="n">dungeon</span><span class="o">.</span><span class="n">set_verbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">()</span>
            <span class="n">dungeon</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">start_prompt</span><span class="p">:</span>
                <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press enter to continue...&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Let the hunt begin!&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">turn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dungeon</span><span class="o">.</span><span class="n">outcome</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> gets the treasure and returns a hero!&quot;</span>
                        <span class="p">)</span>
                        <span class="n">tprint</span><span class="p">(</span><span class="s2">&quot;WINNER&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> will eat tonight!&quot;</span><span class="p">)</span>
                        <span class="n">tprint</span><span class="p">(</span><span class="s2">&quot;GAME OVER&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Turn </span><span class="si">{</span><span class="n">turn</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">dungeon</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c1"># no outcome in max steps (e.g. no treasure and troll can&#39;t reach adventurer)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No one saw </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">adventurer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> or </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dungeon</span><span class="o">.</span><span class="n">troll</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> again.&quot;</span>
            <span class="p">)</span>
            <span class="n">tprint</span><span class="p">(</span><span class="s2">&quot;STALEMATE&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">outcomes</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">:</span>
            <span class="n">outcomes</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">outcomes</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">/</span> <span class="n">trials</span>
        <span class="k">return</span> <span class="n">outcomes</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="playing-games">
<h2>Playing Games<a class="headerlink" href="#playing-games" title="Permalink to this headline">#</a></h2>
<section id="dungeon-yaml-files">
<h3>Dungeon YAML files<a class="headerlink" href="#dungeon-yaml-files" title="Permalink to this headline">#</a></h3>
<p>Dungeons can be specified with YAML files, and we have provided a few examples in the <code class="docutils literal notranslate"><span class="pre">dungeons/</span></code> directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;dungeons&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;dungeon.yml&#39;,
 &#39;test_stalemate.yml&#39;,
 &#39;test_win50.yml&#39;,
 &#39;test_lose100.yml&#39;,
 &#39;test_win100.yml&#39;]
</pre></div>
</div>
</div>
</div>
<p>The files starting <code class="docutils literal notranslate"><span class="pre">test_</span></code> are simlper dungeons with known outcome proabilities (which could be used in unit testing, for example).</p>
</section>
<section id="run-a-single-game">
<h3>Run a single game<a class="headerlink" href="#run-a-single-game" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Dungeon</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;dungeons/dungeon.yml&quot;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> _____            _  _   _____                                     
|_   _| _ _  ___ | || | |_   _| _ _  ___  __ _  ___ _  _  _ _  ___ 
  | |  | &#39;_|/ _ \| || |   | |  | &#39;_|/ -_)/ _` |(_-&lt;| || || &#39;_|/ -_)
  |_|  |_|  \___/|_||_|   |_|  |_|  \___|\__,_|/__/ \_,_||_|  \___|
                                                                   


The Adventurer is looking for treasure in a mysterious dungeon.
Will they succeed or be dinner for the Troll that lurks there?

The map of the dungeon is below:
o : an empty room
o - o : connected rooms
T : Troll
a : Adventurer
* : the treasure
            
        *           
        |        
    o - o - o       
    |       |    
o - a       o - T   
    |       |    
    o - o - o       
        |        
        o           

Let the hunt begin!

Turn 1
Adventurer moves down
Troll moves left

        *           
        |        
    o - o - o       
    |       |    
o - o       T - o   
    |       |    
    a - o - o       
        |        
        o           

Turn 2
Adventurer moves up
Troll moves down

        *           
        |        
    o - o - o       
    |       |    
o - a       o - o   
    |       |    
    o - o - T       
        |        
        o           

Turn 3
Adventurer moves down
Troll moves left

        *           
        |        
    o - o - o       
    |       |    
o - o       o - o   
    |       |    
    a - T - o       
        |        
        o           

Turn 4
Adventurer moves up
Troll moves down

        *           
        |        
    o - o - o       
    |       |    
o - a       o - o   
    |       |    
    o - o - o       
        |        
        T           

Turn 5
Adventurer moves left
Troll moves up

        *           
        |        
    o - o - o       
    |       |    
a - o       o - o   
    |       |    
    o - T - o       
        |        
        o           

Turn 6
Adventurer moves right
Troll moves down

        *           
        |        
    o - o - o       
    |       |    
o - a       o - o   
    |       |    
    o - o - o       
        |        
        T           

Turn 7
Adventurer moves left
Troll moves nowhere

        *           
        |        
    o - o - o       
    |       |    
a - o       o - o   
    |       |    
    o - o - o       
        |        
        T           

Turn 8
Adventurer moves right
Troll moves nowhere

        *           
        |        
    o - o - o       
    |       |    
o - a       o - o   
    |       |    
    o - o - o       
        |        
        T           

Turn 9
Adventurer moves left
Troll moves up

        *           
        |        
    o - o - o       
    |       |    
a - o       o - o   
    |       |    
    o - T - o       
        |        
        o           

Turn 10
Adventurer moves right
Troll moves left

        *           
        |        
    o - o - o       
    |       |    
o - a       o - o   
    |       |    
    T - o - o       
        |        
        o           

No one saw Adventurer or Troll again.
 ___  _____    _    _     ___  __  __    _    _____  ___ 
/ __||_   _|  /_\  | |   | __||  \/  |  /_\  |_   _|| __|
\__ \  | |   / _ \ | |__ | _| | |\/| | / _ \   | |  | _| 
|___/  |_|  /_/ \_\|____||___||_|  |_|/_/ \_\  |_|  |___|
                                                         
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimate-outcome-probabilities">
<h3>Estimate outcome probabilities<a class="headerlink" href="#estimate-outcome-probabilities" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Dungeon</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;dungeons/dungeon.yml&quot;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">probability</span><span class="p">(</span><span class="n">max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># -1: troll wins, 0: stalemate, +1: adventurer wins</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{-1: 0.2245, 0: 0.5869, 1: 0.1886}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./module06_software_projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="06_08_software_issues.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">6.8 Managing software issues</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../module07_construction_and_design/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">7. Construction and Design</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By various <a href="https://github.com/alan-turing-institute/rse-course/graphs/contributors">contributors</a>.
Developed at <a href="https://turing.ac.uk">The Alan Turing Institute</a> based on the <a href="https://github.com/UCL/rsd-engineeringcourse">UCL RSD course</a>.
<br/>
  
    <div class="extra_footer">
      <p>Creative Commons Attribution 2.0 Generic (<a href="https://creativecommons.org/licenses/by/2.0/">CC BY 2.0</a>).</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>